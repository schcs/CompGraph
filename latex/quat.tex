\documentclass[12pt]{amsart}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{showkeys}
%\usepackage{tikz-cd}

\renewcommand{\a}{\mathfrak a}
\renewcommand{\b}{\mathfrak b}
\newcommand{\m}{\mathfrak m}
\newcommand{\n}{\mathfrak n}
\newcommand{\p}{\mathfrak p}
\newcommand{\q}{\mathfrak q}
\renewcommand{\r}{\mathfrak r}
\newcommand{\F}{\mathbb F}
\renewcommand{\L}{\mathbb L}
\newcommand{\Q}{\mathbb Q}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\C}{\mathbb C}
\newcommand{\Ha}{\mathbb H}


\newcommand{\K}{\mathbb K}
\newcommand{\R}{\mathbb R}
\newcommand{\fracf}[1]{\mbox{Frac}(#1)}
\newcommand{\spec}[1]{\mbox{Spec}(#1)}
\newcommand{\len}{\mbox{len}\,}
\newcommand{\id}{\mbox{id}\,}
\DeclareMathOperator{\sen}{\textrm{\rm sen}}
%\newcommand{\sen}{\mbox{sen}\,}
\newcommand{\gl}[1]{\mbox{GL}_{#1}}
\newcommand{\SL}[1]{\mbox{SL}_{#1}}
\newcommand{\glv}[1]{\mbox{GL}(#1)}
\newcommand{\slv}[1]{\mbox{SL}(#1)}
\newcommand{\Sym}{\mbox{Sym}}
\usepackage[portuguese]{babel}
\newcommand{\rot}[1]{{\textrm{Rot}}_{#1}}
\newcommand{\refl}[1]{{\textrm{Ref}}_{#1}}




\newtheorem{theorem}{Teorema}
\newtheorem{corollary}[theorem]{Corolário}
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{exercise}[theorem]{Exercício}

\theoremstyle{definition}
\newtheorem{example}[theorem]{Exemplo}
\newtheorem{definition}[theorem]{Definição}





\oddsidemargin 0pt
\evensidemargin 0pt
\textheight 8.1in \textwidth 6.3in


\relpenalty=10000
\binoppenalty=10000
\tolerance=500


\begin{document}
\date{\today}
\title[Quatérnios]{Os quatérnios e as rotações em $\R^3$}
\maketitle


\section{A álgebra dos quatérnios}

Seja $\Ha$ o espaço vetorial de dimensão $4$ gerado por $1,i,j,k$. Introduzimos uma multiplicação em $\Ha$ com a seguinte tabela de multiplicação:

\begin{center}
        \begin{tabular}{|l||l|l|l|l|}
        \hline
            & 1   & $i$  & $j$  & $k$  \\ \hline\hline
        1   & 1   & $i$  & $j$  & $k$  \\ \hline
        $i$ & $i$ & $-1$ & $k$  & $-j$ \\ \hline
        $j$ & $j$ & $-k$ & $-1$ & $i$  \\ \hline
        $k$ & $k$ & $j$  & $-i$ & $-1$ \\ \hline
        \end{tabular}
\end{center}
Note que o conjunto $\{1,-1,i,-i,j,-j,k,-k\}$ é um grupo para esta multiplicação. 
A multiplicação entre os elementos $1,i,j,k$ será estendida com a regra distributiva. Um elemento de $\Ha$ chama-se um \emph{quatérnio} e e conjunto $\Ha$ chama-se a \emph{álgebra dos quatérnios}. A seguinte lema é fácil de verificar por conta direta.

\begin{lemma}
    A álgebra dos quatérnios é um espaço vetorial de dimensão $4$ com uma multiplicação bem definida. Além disso, a multiplicação é associativa, possui elemento neutro (o elemento $1$), mas não é comutativa. A estrutura satisfaz a lei distributiva:
    \[
        q_1(q_2+q_3)=q_1q_2+q_1q_3\quad\mbox{e}\quad(q_1+q_2)q_3=q_1q_3+q_2q_3.
    \]
\end{lemma}

Todo quatérnio $q\in\Ha$ pode ser escrito unicamente na forma $q=\alpha_q+v_q$ onde $\alpha_q\in\R$ e 
$v_q\in\left<i,j,k\right>$. Um quatérnio com $v_q=0$ chama-se \emph{escalar}, enquanto um quatérnio com 
$\alpha_q=0$ chama-se \emph{quatérnio puro}. Pode-se definir o produto escalar entre quatérnios como no espaço
$\R^3$ pela regra
\[
    (p,q)=\alpha_p\alpha_q+\beta_p\beta_q+\gamma_p\gamma_q+\delta_p\delta_q
\]
para todo $p=\alpha_p+\beta_pi+\gamma_pj+\delta_pk$ e $q=\alpha_q+\beta_qi+\gamma_qj+\delta_qk$.
(O produto escalar será denotado por $(\cdot,\cdot)$ para não confundir com a multiplicacão.)
Em relação com este produto escalar, os elementos $1$, $i$, $j$, e $k$ formam uma base ortonormal de 
$\Ha$.
A norma de um quatérnio na forma $q=\alpha+\beta i+\gamma j+\delta k$ é definida como 
\[
    \|q\|=\sqrt{(q,q)}=\sqrt{\alpha^2+\beta^2+\gamma^2+\delta^2},
\]
enquanto o conjugado $\bar q$ está definido como 
\[
    \bar q=\alpha-\beta i-\gamma j-\delta.
\]
A norma e o conjugado entre quatérnios satisfaz propriedades similares que a norma e o 
conjugado para números complexos.

\begin{lemma}
    As seguintes afirmações são verdadeiras para $q\in\Ha$.
    \begin{enumerate}
        \item $\alpha_q=(q+\bar q)/2$; 
        \item $v_q=(q-\bar q)/2$;
        \item $\overline{q_1+q_2}=\bar q_1+\bar q_2$ e $\overline{q_1q_2}=\bar q_2\cdot \bar q_1$ (note a troca na ordem!);
        \item $\|q\|=0$ se e somente se $q=0$;
        \item $\|q_1+q_2\|\leq \|q_1\|+ \|q_2\|$;
        \item  $\|q_1\cdot q_2\|= \|q_1\|\|q_2\|$;
        \item $\|\alpha q\|=|\alpha|\|q\|$ para $\alpha\in\R$;
        \item $\|q\|^2=q\cdot \bar q$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    Deixamos a maioria destas afirmações para exercício. 
    Para (8), calculemos que 
    \begin{align*}
        q\cdot \bar q&=(\alpha+\beta i+\gamma j+\delta k)(\alpha-\beta i-\gamma j-\delta k)\\&= 
        \alpha^2+\beta^2+\gamma^2+\delta^2=\|q\|^2.
    \end{align*}
\end{proof}

\begin{corollary}
    Seja $q=\alpha_q+v_q=\alpha+\beta i+\gamma j+\delta k\in\Ha\setminus\{0\}$. Então $q$ possui inverso multiplicativo 
    e 
    \[
        q^{-1}=\frac{\bar q}{\|q\|^2}=\frac{\alpha-\beta i-\gamma j-\delta k}{\alpha^2+\beta^2+\gamma^2+\delta^2}.
    \]
    Em outras palávras, $\Ha\setminus\{0\}$ é grupo para a multiplicação.
\end{corollary}
\begin{proof}
    Segue da afirmação (8) do lema anterior que 
    \[
        q\cdot \frac{\bar q}{\|q\|^2}=\frac{\|q\|^2}{\|q\|^2}=1.
    \]
\end{proof}

Um quatérnio $q\in\Ha$ chama-se \emph{unitário} se $\|u\|=1$.

\begin{lemma}
    O elemento $1\in\Ha$ é unitário, e se $q\in\Ha$ é unitário, então $q^{-1}$ é unitário. Logo, os quatérnios unitários formam um grupo para a multiplicação. Além disso, se $q\in\Ha$ é unitário, então $q^{-1}=\bar q$.   
\end{lemma}

Para $q_1,q_2\in\Ha$, defina o comutador 
\[
    [q_1,q_2]=\frac 12(q_1q_2-q_2q_1).
\]

\begin{lemma}
    O comutador satisfaz as seguintes propriedades para todo $q_1,q_2,q_3\in\Ha$:
    \begin{enumerate}
        \item $[q_1+q_2,q_3]=[q_1,q_3]+[q_2,q_3]$ e $[q_1,q_2+q_3]=[q_1,q_2]+[q_1,q_3]$ (distributividade);
        \item $[q_1,q_1]=0$ e $[q_1,q_2]=-[q_2,q_1]$ (anti-comutatividade);
        \item $[[q_1,q_2],q_3]+[[q_2,q_3],q_1]+[[q_3,q_1],q_2]=0$ (identidade de Jacobi).
    \end{enumerate}
\end{lemma}


As identidades no lema anterior implicam que a estrutura $(\Ha,+,[\cdot,\cdot])$ é uma \emph{álgebra de Lie}. 
Seja $Q$ o espaço dos quatérnios puros. Então $Q$ é um espaço vetorial de dimensão 3 gerado por $i$, $j$, e $k$. Note que $Q$ não é fechado para o produto $\cdot$ entre os quatérnios (por exemplo $i\cdot i=i^2=-1\not\in Q$), mas ele é fechado para o comutador. 
De fato, temos que $[i,j]=k$, $[j,k]=i$ e $[k,i]=j$. Ou seja, o comutador no espaço $k$ comporta-se 
exatamente como o produto vetorial $\times$ sobre $\R^3$. Além disso, $[1,q]=0$ para todo $q\in\Ha$.  


\begin{lemma}
    As seguintes propriedades são válidas para $q=\alpha_q+v_q$ e $p=\alpha_p+v_p$:
    \begin{enumerate}
        \item $[p,q]=[v_p,v_q]$;
        \item $p\cdot q=\alpha_p\alpha_q-(v_p,v_q)+\alpha_p v_q+\alpha_qv_p+v_p\times v_q=\alpha_p\alpha_q-(v_p,v_q)+\alpha_p v_q+\alpha_qv_p+[p,q]$;
        \item Se $p$ e $q$ são quatérnios puros, então $p\cdot q=-(p, q)+p\times q=-(p, q)+[p,q]$.
        \item Se $p$ e $q$ são quatérnios puros ortogonais, então $p\cdot q=p\times q$.
        \item Se $p$ é puro unitário, então $p^2=-1$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    (1)--(4) Uma conta usando as definições. Para provar (5), note que item~(3) implica que 
    \[
        v^2=-(v, v)+v\times v=-(v, v)=-\|v\|^2=-1. 
    \]
\end{proof}


Se $q=\alpha_q+v_q\in\Ha$ com $v_q\neq 0$, então 
\[
    q=\alpha_q+\|v_q\|\frac{v_q}{\|v_q\|}=\alpha_q+\beta_qu_q
\]
onde $u_q$ é um quatérnio puro unitário. Além disso, se $\|q\|=1$, como $\alpha_q\perp v_q$,
\[
    1=\|q\|=\alpha_q^2+\beta_q^2
\]
então 
\[
    q=\cos\vartheta_q+\sen\vartheta_qu_q
\]
com algum ângulo $\vartheta\in[0,2\pi)$.

\begin{theorem}
    Todo quatérnio $q\in\Ha$ unitário pode ser escrito na forma 
    \[
        \cos\vartheta +(\sen\vartheta) u
    \]
    onde $u$ é um quatérnio puro unitário.
    Além disso, se $q\neq 1$, então esta expressão é única.
\end{theorem}
\begin{proof}
    If $v_q\neq 0$, então siga o processo antes do enunciado. Se $v_q=0$, então toma $\vartheta=0$ ou $\vartheta =\pi$ e $u$ arbitrário.
\end{proof}

\begin{lemma}
    Seja $u\in\Ha$ um quatérnio unitário. Então as aplicações 
    \[
        L_u:\Ha\to\Ha,\ L_u(q)=uq\quad\mbox{e}\quad R_u:\Ha\to\Ha,\ R_u(q)=qu^{-1}=q\bar u
    \]
    são transformações ortogonais de $\Ha$ com determinante~$1$; ou seja, $L_u$ e $R_u$ são 
    rotações de $\Ha\cong \R^4$. 
\end{lemma}
\begin{proof}
    Pela distributividade da multiplicação, temos que $L_u$ e $R_u$ são transformações lineares. Além disso
    \[
        \|L_u(q)\|=\|uq\|=\|u\|\|q\|=\|q\|
    \]
    e obtém-se similarmente que $\|R_u(q)\|=\|q\|$; 
    ou seja $L_u$ e $R_u$ preservam a norma. 
    Nós já provamos que para uma transformação linear isso é equivalente 
    a ser ortogonal. Precisamos ainda provar que $\det L_u=\det R_u=1$. Escreva 
    $u=\cos\vartheta+\sen\vartheta u_0$ onde $u_0$ é quatérnio puro unitário. 
    Neste caso $1\perp u_0$ e escolha um quatérnio puro unitário $v$ tal que 
    $u_0\perp v$ e seja $w=[u_0,v]=u_0\times v$. Então temos que a matriz de $L_u$ na base $1,u_0,v,w$ é 
    \[
        [L_{u_0}]=\begin{pmatrix} 0 & -1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & -1 \\ 0 & 0 & 1 & 0\end{pmatrix}
    \]
    e
    a matriz de $L_u=(\cos\vartheta)I+(\sen\vartheta) L_{u_0}$ é 
    \[
        [L_u]=\begin{pmatrix} \cos\vartheta & -\sen\vartheta & 0 & 0 \\ \sen\vartheta & \cos\vartheta & 0 & 0 \\ 0 & 0 & \cos\vartheta & -\sen\vartheta \\ 0 & 0 & \sen\vartheta & \cos\vartheta\end{pmatrix}.
    \]
    Segue que $L_u$ pode ser realizada como a composição de duas rotações: a primeira 
    no plano $\left<1,u\right>$ e a segunda no plano $\left<v,w\right>$ com ângulo $\vartheta$. 
    Temos que $\det L_u=(\cos^2\vartheta+\sen^2\vartheta)^2=1$. A computação para $R_u$ é similar. 
    Note que $u^{-1}=\bar u=\cos\vartheta-\sen\vartheta u_0$ e a matriz 
    de $R_u$ na mesma base será 
    \[
        [R_u]=\begin{pmatrix} \cos\vartheta & \sen\vartheta & 0 & 0 \\ -\sen\vartheta & \cos\vartheta & 0 & 0 \\ 0 & 0 & \cos\vartheta & -\sen\vartheta \\ 0 & 0 & \sen\vartheta & \cos\vartheta\end{pmatrix}
    \]
 Ou seja, $R_u$ faz uma rotação no plano $\left<1,u\right>$ com ângulo $-\vartheta$ e uma rotação no plano 
 $\left<v,w\right>$ por ângulo $\vartheta$.
\end{proof}

\begin{theorem}
    Seja $u=\cos\vartheta+(\sen\vartheta)u_0\in\Ha$ um quatérnio unitário. Defina 
    \[
        T_u:\Ha\to \Ha,\quad T_u(q)=uqu^{-1}=(L_u\circ R_u)(q).
    \]
    Então $T_u(1)=1$ e $T_u$ induz uma rotação do espaço $\R^3\cong\left<i,j,k\right>$. O eixo desta rotação é 
    $u_0$ e o seu ângulo é $2\vartheta$.
\end{theorem}
\begin{proof}
    Primeiro
    \[
        T_u(1)=u\cdot 1\cdot u^{-1}=u\cdot u^{-1}=1.
    \]
    Além disso, $T_u$ é uma composição de duas transformações ortogonais, e ela é ortigonal e temos ainda que 
    $\det T_u=\det L_u\cdot\det R_u=1$. Logo $T_u$ é uma rotação de $\Ha$. 
    Consequentemente, $T_u$ preserva $Q=\left<i,j,k\right>=\left<1\right>^{\perp}$. 
    Além disso, $T_u$ preserva a norma em $Q$ e assim a restrição de $T_u$ para $Q$ 
    é uma transformação ortogonal com determinante $1$. Portanto $T_u$ induz uma rotação 
    em $\left<i,j,k\right>$.  O eixo desta rotação pode ser 
    calculado por determinar um autovetor de $T_u$ em $\left<i,j,k\right>$ 
    que corresponde ao autovalor $1$. Mas note que 
    \[
        uu_0=(\cos\vartheta+(\sen\vartheta)u_0)u_0=u_0(\cos\vartheta+(\sen\vartheta)u_0)=
        (\cos\vartheta) u_0-\sen\vartheta=u_0u
    \]
    e assim 
    \[
        T_u(u_0)=uu_0u^{-1}=u_0uu^{-1}=u_0
    \]
    e obtemos que o eixo de $T_u$ em $\left<i,j,k\right>$ é $u$.

    Finalmente, temos que verificar a afirmação sobre o ângulo. Escreva $u=\cos\vartheta+(\sen\vartheta)u_0$
    onde $u_0$ é puro e unitário. Como na demonstração anterior, considere a base $1,u_0,v,w$ onde 
    $v\in Q$ unitário ortogonal a $u$ e $w=u\times v$. Como $T_u$ é a composição de $L_u$ e $R_u$, temos 
    que a matriz de $T_u$ nesta base é o produto das matrizes de $L_u$ e $R_u$ e assim
    \begin{align*}
        [T_u]&=\begin{pmatrix} \cos\vartheta & -\sen\vartheta & 0 & 0 \\ \sen\vartheta & \cos\vartheta & 0 & 0 \\ 0 & 0 & \cos\vartheta & -\sen\vartheta \\ 0 & 0 & \sen\vartheta & \cos\vartheta\end{pmatrix}
        \begin{pmatrix} \cos\vartheta & \sen\vartheta & 0 & 0 \\ -\sen\vartheta & \cos\vartheta & 0 & 0 \\ 0 & 0 & \cos\vartheta & -\sen\vartheta \\ 0 & 0 & \sen\vartheta & \cos\vartheta\end{pmatrix}\\
        &=\begin{pmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & \cos(2\vartheta) & -\sen(2\vartheta) \\ 0 & 0 & \sen(2\vartheta) & \cos(2\vartheta)\end{pmatrix}.
    \end{align*}
\end{proof}
\begin{corollary}
    Toda rotação $T$ de $\R^3=\left<i,j,k\right>$ pode ser realizado como $T_u$ com algum $u\in\Ha$ unitário. 
    Além disso, se $u,v\in\Ha$ são unitários, então $T_u=T_v$ se e somente se $u=\pm v$. 
\end{corollary}
\begin{proof}
    Seja $u_0$ o eixo de $T$ e $\vartheta$ o ângulo da rotação. Toma 
    \[
        u=\cos(\vartheta/2)+(\sen(\vartheta/2))u_0.
    \] 
    Pelo teorema anterior, $T=T_{u}$.

    Para provar a segunda afirmação, primeiro provaremos que $T_u=\id$ se e somente se 
    $u=\pm 1$. Primeiro, se $u=\pm 1$, então $T_u=\id$. Assuma que $T_u=\id$. 
    Assuma que $u,v\in\Ha$ são unitários e escreva $u=\cos\alpha+\sen\alpha u_0$. 
    O ângulo da rotação é $2\alpha$. Temos que $T_u=\id$ se e somente se $2\alpha$ 
    é um múltiplo de $2\pi$, ou seja $\alpha=0$ ou $\alpha=\pi$. Obtemos nos dois casos
    que $u=1$ ou $u=-1$. Assuma agora que $T_u=T_v$ com $u,v\in\Ha$ unitários. 
    Temos que 
    \[
        \id =T_uT_v^{-1}=T_uT_{\bar v}=T_{u\bar v}.
    \]
    Pelo afirmação anterior, $u\bar v=\pm 1$ e assim $u=\pm v$. 
\end{proof}

\begin{corollary}
    O grupo $SO(\R^3)$ das rotações de $\R^3$ pode ser identificado com a meia esfera $S^3\subseteq \R^4$. 
    Dois elementos $u,v\in S^3$ representam a mesma rotação se e somente se $u=\pm v$. 
\end{corollary}

\subsection{A composição de rotações}
Sejam $u=\cos\vartheta+(\sen\vartheta)u_0$ e $v=\cos\beta+(\sen\beta)v_0$ quatérnios unitários. 
Note, para todo $x\in\Ha$ que 
\[
    T_{uv}(x)=uvx(uv)^{-1}=uvxv^{-1}u^{-1}=T_u\circ T_v(x).
\] 
Logo,
\[
    T_{uv}=T_u\circ T_v.
\]
Além disso, $uv$ é quatérnio unitário e  
\begin{align*}
    uv&=(\cos\vartheta+(\sen\vartheta)u_0)(\cos\beta+(\sen\beta)v_0)\\
    &=\cos\vartheta\cos\beta+(\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+\sen\vartheta\sen\beta u_0 v_0\\
    &=\cos\vartheta\cos\beta+(\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+\sen\vartheta\sen\beta(-(u_0,v_0)+u_0\times v_0)\\
    &=\cos\vartheta\cos\beta -\sen\vartheta\sen\beta(u_0,v_0)+(\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+(\sen\vartheta\sen\beta) u_0\times w_0\\
    &=\cos\vartheta\cos\beta -\sen\vartheta\sen\beta(u_0,v_0)+w
\end{align*} 
com $w$ puro
(na útlima equação usamos que $u_0$, $v_0$ são puros e unitários).
A parte constante de $uv$ é $\cos\vartheta\cos\beta-\sen\vartheta\sen\beta(u_0,v_0)$. Para escrever $uv$ na forma 
$\cos\alpha+(\sen\alpha)w_0$, precisamos calcular $\|w\|$. Usando que $u_0$ e $v_0$ são ambos  
ortogonais a $u_0\times v_0$, e que $u_0$, $v_0$ e $u_0\times v_0$ são unitários, obtemos que 
\begin{align*}
    \|w\|^2&=\|(\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+(\sen\vartheta\sen\beta)u_0\times v_0\|^2\\
    &=((\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+(\sen\vartheta\sen\beta)u_0\times v_0,\\
    &=(\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+(\sen\vartheta\sen\beta)u_0\times v_0)\\
    &=\sen^2\vartheta\sen^2\beta\sen^2\varphi+\cos^2\vartheta\sen^2\beta+\cos^2\beta\sen^2\vartheta+
    2\cos\vartheta\sen\beta\cos\beta\sen\vartheta\cos\varphi\\&=
    \sen^2\vartheta\sen^2\beta\sen^2\varphi+(\cos\vartheta\sen\beta+\cos\beta\sen\vartheta)^2+2\cos\vartheta\sen\beta\cos\beta\sen\vartheta(\cos\varphi-1)\\
    &=\sen^2\vartheta\sen^2\beta\sen^2\varphi+\sen^2(\vartheta+\beta)+\frac{\cos^2(\vartheta-\beta)-\cos^2(\vartheta+\beta)}{2}(\cos\varphi-1)\\
\end{align*}
Então temos que 
\[
    uv=w=\alpha_w+\beta_ww_0
\]
onde
\begin{align*}
    \alpha_w&= \cos\vartheta\cos\beta-\sen\vartheta\sen\beta(u_0,v_0)=\cos\vartheta\cos\beta-\sen\vartheta\sen\beta\cos\varphi\\
    \beta_w&=\left(\sen^2\vartheta\sen^2\beta\sen^2\varphi+\sen^2(\vartheta+\beta)+\frac{\cos^2(\vartheta-\beta)-\cos^2(\vartheta+\beta)}{2}(\cos\varphi-1)\right)^{1/2}\\
    w_0&=\frac{(\cos\vartheta\sen\beta) v_0+(\cos\beta\sen\vartheta) u_0+(\sen\vartheta\sen\beta)u_0\times v_0}{\beta_w}.
\end{align*} 
onde $w_0=w/\|w\|$ é um quatérnio unitário puro.

\begin{theorem}
    Sejam $R_1=R(k_1,\vartheta_1)$ e $R_2=R(k_2,\vartheta_2)$ rotações de $\R^3$ e assuma que 
    $\|k_1\|=\|k_2\|=1$ e que $\varphi$ é o ângulo entre $k_1$ e $k_2$ (ou seja, $\cos\varphi=(k_1,k_2)$). Então a composição 
    $R=R_1\circ R_2$ é uma rotação. O eixo de $R$ é
    \[
        k=(\cos\vartheta_1\sen\vartheta_2) k_2+(\cos\vartheta_2\sen\vartheta_1) k_1+
        (\sen\vartheta_1\sen\vartheta_2)k_1\times k_2
    \] 
    e o ângulo de $R$ é o ângulo $\vartheta$ que satisfaz 
    \begin{align*}
        \cos(\vartheta/2)&=\cos(\vartheta_1/2)\cos(\vartheta_2/2)-\sen(\vartheta_1/2)\sen(\vartheta_2/2)\cos\varphi\\
        \sen(\vartheta/2)&=\|k\|\\&=\left(\sen^2(\vartheta_1/2)\sen^2(\vartheta_2/2)\sen^2(\varphi)+\sen^2((\vartheta_1\vartheta_2)/2)\right.\\
        &\left.+\frac{\cos^2((\vartheta_1-\vartheta_2)/2))-\cos^2((\vartheta_1+\vartheta_2)/2)}{2}(\cos\varphi-1)\right)^{1/2}
    \end{align*}
\end{theorem}

\subsection{O mapa exponencial}

Lembre que para um número real $\alpha\in\R$ (ou complexo $\alpha\in\C$), temos as seguintes séries de Taylor:  
\begin{align*}
    e^\alpha &= \exp\alpha=\sum_{n=0}^\infty \frac{\alpha^n}{n!}\\
    \sen\alpha&=\sum_{n=0}^\infty\frac{(-1)^n\alpha^{2n+1}}{(2n+1)!}\\
    \cos\alpha&=\sum_{n=0}^\infty\frac{(-1)^n\alpha^{2n}}{(2n)!}.\\
\end{align*}

Seja $v\in\R^3\setminus\{0\}$ e considere $v$ um quatérnio puro de $\Ha$. Pondo $\alpha=\|v\|$, podemos escrever $v=\alpha v_0$ onde $v_0$ é um quatérnio puro unitário. Lembrando que $v_0^2=-1$, temos que 
\[
    v_0^0=1,\  v_0^1=v_0,\ v_0^2=-1,\ v_0^3=-v_0,\ v_0^4=1,\ v_0^5=v_0,\ldots \mbox{etc.}
\]
Mais precisamente temos que 
\[
    v_0^k=\left\{\begin{array}{ll}1 & \mbox{se $k\equiv 0\pmod 4$;}\\
                                  v_0 &  \mbox{se $k\equiv 1\pmod 4$;}\\
                                  -1 & \mbox{se $k\equiv 2\pmod 4$;}\\
                                  -v_0 & \mbox{se $k\equiv 3\pmod 4$;}
    \end{array}\right.
\]
Assim podemos escrever que 
\[
    \exp(v)=\exp(\alpha v_0)=\sum_{n=0}^\infty \frac{\alpha^nv_0^n}{n!}=
    \sum_{n=0}^\infty \frac{(-1)^n\alpha^{2n}}{(2n)!}+
    \left(\sum_{n=0}^\infty \frac{(-1)^n\alpha^{2n+1}}{(2n+1)!}\right)v_0
    =\cos\alpha+(\sen\alpha) v_0.
\]
Em outras palávras, $\exp(v)$ é um quatérnio unitário. Assim obtemos um mapa 
\[
    \exp:\Ha \to \{u\in\Ha\mid \|u\|=1\},\quad v\mapsto \exp(v).
\]
Note que o mapa $\exp$ é sobrejetiva, mas não é injetiva, pois 
$\exp(\alpha v_0)=\exp((\alpha+2\pi)v_0)$, mas podemos definir 
para $q=\cos\alpha+(\sen\alpha)v_0$ o seu logaritmo como  
\[
    \log q=\alpha v_0
\]
e assim temos que 
\[
    \exp(\log q)=q
\]
para todo $q\in\Ha$ unitário.

O exponencial e logaritmo nos permite definir para um quatérnio puro $q$ e para um $t\in\R$, 
o exponencial $q^t$ como 
\[
    q^t=e^{\log q\cdot t}=\exp(t\log q).
\]

\subsection{Interpolação geodésica}
Dados $R_1,R_2\in SO_3$, queremos obter um caminho suave 
composto por rotações em $SO_3$ 
entre $R_1$ e $R_2$ com a propriedade que a ``velocidade do caminho'' é constante.
Matematicamente, nós queremos obter uma curva suave
\[
    \varphi:[0,1]\to SO_3,\quad \varphi(0)=R_0\quad\mbox{e}\quad \varphi(1)=R_1
\]
com $(d/dt)\varphi(t)$ constante.

Sejam $R_1$ e $R_2$ representadas por quatérnions 
\[
    p=\cos\alpha+(\sen\alpha)p_0\quad\mbox{e}\quad q=\cos\beta+(\sen\beta)q_0
\]
onde $\alpha,\beta\in[0,2\pi)$ e $p_0,q_0\in \Ha$ são quatérnios unitários.
Representando os quatérnios nesse jeito, o nosso problema pode ser visto como o problema de achar 
uma curva suave
\[
    \varphi:[0,1]\to \{v\in\Ha\mid \|v\|=1\}
\]
com $\varphi(0)=p$ e $\varphi(1)=q$ tal que $d\varphi/dt$ constante.

Assuma primeiro que $p=1$. Neste caso defina 
\[
    \varphi:[0,1]\to SO_3,\quad \varphi(t)=\cos(t\beta)+\sen(t\beta)q_0=\exp(t\beta q_0)=
    \exp(t\log q)=q^t.
\]
Claramente, $\varphi(0)=1$ e $\varphi(1)=q$. Além disso 
\[
    \frac d{dt}\varphi(t)=-\sen(t\beta)\beta+\cos(t\beta)\beta q_0
\]
e assim 
\[
    \|\frac d{dt}\varphi(t)\|=|\beta|.
\]
Assim, $(d/dt)\varphi(t)$ é constante e assim a curva $\varphi$ pode ser vista como uma curva de velocidade
constante. Pode ainda verificar que $\varphi$ é uma curva ao longo de uma geodésica. 

Sejam agora $p,q\in\Ha$ unitários e escreva 
\[
p=\cos\alpha+(\sen\alpha)p_0\quad\mbox{e}\quad q=\cos\beta+(\sen\beta)q_0
\]
Considere a curva 
\[
    \varphi_0:[0,1]\to SO_3,\quad \varphi(t)=(qp^{-1})^t.
\]
Ora a curva $\varphi$ desejada será obtida como o produto $\varphi_0(t)p$:
\[
    \varphi(t)=(qp^{-1})^tp.
\]
Claramente, $\varphi(0)=p$, $\varphi(1)=q$ e $(d/dt)\varphi(t)$ é constante. 
\end{document}
 