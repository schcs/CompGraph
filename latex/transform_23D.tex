\documentclass[12pt]{amsart}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{showkeys}
%\usepackage{tikz-cd}

\renewcommand{\a}{\mathfrak a}
\renewcommand{\b}{\mathfrak b}
\newcommand{\m}{\mathfrak m}
\newcommand{\n}{\mathfrak n}
\newcommand{\p}{\mathfrak p}
\newcommand{\q}{\mathfrak q}
\renewcommand{\r}{\mathfrak r}
\newcommand{\F}{\mathbb F}
\renewcommand{\L}{\mathbb L}
\newcommand{\Q}{\mathbb Q}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\C}{\mathbb C}


\newcommand{\K}{\mathbb K}
\newcommand{\R}{\mathbb R}
\newcommand{\fracf}[1]{\mbox{Frac}(#1)}
\newcommand{\spec}[1]{\mbox{Spec}(#1)}
\newcommand{\len}{\mbox{len}\,}
\newcommand{\id}{\mbox{id}\,}
\DeclareMathOperator{\sen}{\textrm{\rm sen}}
%\newcommand{\sen}{\mbox{sen}\,}
\newcommand{\gl}[1]{\mbox{GL}_{#1}}
\newcommand{\SL}[1]{\mbox{SL}_{#1}}
\newcommand{\glv}[1]{\mbox{GL}(#1)}
\newcommand{\slv}[1]{\mbox{SL}(#1)}
\newcommand{\Sym}{\mbox{Sym}}
\usepackage[portuguese]{babel}
\newcommand{\rot}[1]{{\textrm{Rot}}_{#1}}
\newcommand{\refl}[1]{{\textrm{Ref}}_{#1}}




\newtheorem{theorem}{Teorema}
\newtheorem{corollary}[theorem]{Corolário}
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{exercise}[theorem]{Exercício}

\theoremstyle{definition}
\newtheorem{example}[theorem]{Exemplo}
\newtheorem{definition}[theorem]{Definição}





\oddsidemargin 0pt
\evensidemargin 0pt
\textheight 8.1in \textwidth 6.3in


\relpenalty=10000
\binoppenalty=10000
\tolerance=500


\begin{document}

\title[Isometrias do espaço]{Transformações ortogonais em 2D e 3D}
\maketitle


\section{O plano (2D)}

\subsection{Realização matricial}
Lembre que a matriz da reflexão $R_t$ pelo eixo que tem ângulo $\alpha$ pelo eixo $x$ é
\[ 
\begin{pmatrix}\cos(2\alpha) & \sen(2\alpha) \\ \sen(2\alpha) & -\cos(2\alpha).
\end{pmatrix}
\]

Seja $T:\R^2\to\R^2$ uma transformação ortogonal e seja $e_1,e_2$ a base canônica. 
A matriz de $T$ tem os vetores $f_1=T(e_1)$ e $f_2=T(e_2)$ nas colunas. Pela ortogonalidade de 
$T$, $f_1$ e $f_2$ formam uma base ortonormal de $\R^2$. Assuma que $f_1=(a,b)$ com $\|f_1\|=a^2+b^2=1$. Então 
$f_2=(-b,a)$ ou $b_2=(b,-a)$.  Escolha um ângulo $\alpha$ tal  que $a=\cos\alpha$ e $b=\sen\alpha$. 
Então a matriz $[T]$ de $T$ tem duas possíveis formas:
\[ 
    \mbox{Caso I:}\ [T]=\begin{pmatrix}\cos \alpha & -\sen \alpha\\\sen\alpha &\cos\alpha\end{pmatrix}\\
    \qquad
    \mbox{Caso II:}\ [T]=\begin{pmatrix}\cos \alpha & \sen \alpha\\\sen\alpha &-\cos\alpha\end{pmatrix}.
\]

Seja 

\begin{lemma}
    No primeiro caso $T$ é a rotação $\rot\alpha$ pelo ângulo $\alpha$. No segundo caso, $T$ é a 
    reflexão $\refl{\alpha/2}$ pelo eixo que 
    tem ângulo $\alpha/2$ com o eixo $x$. 
\end{lemma}

\begin{lemma}
    Temos as seguintes regras para a composição de rotações e reflexões.
    \begin{enumerate}
        \item $\rot{\alpha}\circ\rot{\beta}=\rot{\alpha+\beta}$;
        \item $\refl{\alpha}\circ\refl{\beta}=\rot{2(\alpha-\beta)}$;
        \item $\rot{\alpha}\circ\refl{\beta}=\refl{\beta+\alpha/2}$;
        \item $\refl{\alpha}\circ\rot{\beta}=\refl{\alpha-\beta/2}$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    (1) é exercício. Demonstremos (2). Seja $v\in\R^2$ e calculemos que 
    \begin{align*}
        &\refl{\alpha}\circ\refl{\beta}(v)=\begin{pmatrix}\cos(2\alpha) & \sen (2\alpha)\\\sen (2\alpha) &-\cos (2\alpha)\end{pmatrix}\cdot \begin{pmatrix}\cos (2\beta) & \sen (2\beta)\\\sen(2\beta) &-\cos(2\beta)\end{pmatrix}v\\
        &=\begin{pmatrix}
            \cos(2\alpha)\cos(2\beta)+\sen(2\alpha)\sen(2\beta) & \cos(2\alpha)\sen(2\beta)-\sen(2\alpha)\cos(2\beta)\\
            \sen(2\alpha)\cos(2\beta)-\cos(2\alpha)\sen(2\beta) & 
            \sen(2\alpha)\sen(2\beta)+\cos(2\alpha)\cos(2\beta)
        \end{pmatrix}v\\
        &=\begin{pmatrix} \cos(2(\alpha-\beta)) &  -\sen(2(\alpha-\beta))\\
            \sen(2(\alpha-\beta)) & \cos(2(\alpha-\beta)) 
        \end{pmatrix} v \\
        &=\rot{2(\alpha-\beta)}(v)
    \end{align*}
    
    (3) Temos que 
    \[
        \refl{\beta+\alpha/2}\circ(\refl{\beta})^{-1}=\refl{\beta+\alpha/2}\circ(\refl{\beta})=\rot{2(\beta-\alpha-\beta)}=\rot{\alpha}
    \]
    que implica afirmação (3). A demonstração de (4) é similar à demonstração de (3).
\end{proof}

\begin{example}
    Seja $\alpha\in[0,2\pi)$ e considere $\rot \alpha:\R^2\to\R^2$ a rotação por ângulo $\alpha$ ao redor 
    da origem. Os autovalores de $\rot\alpha$ são raízes do polinômio caraterístico
    \begin{align*}
        \det(t\cdot\id-\rot\alpha)&=\det\begin{pmatrix} t-\cos \alpha & \sen\alpha \\ -\sen\alpha &t-\cos\alpha
        \end{pmatrix}\\&=(t-\cos \alpha)^2+\sen^2\alpha=t^2-2t\cos\alpha +\sen^2\alpha\\&=
        t^2-2t\cos\alpha+1.
    \end{align*}
    As raízes deste polinômio são $z=\cos\alpha+i\sen\alpha$ e $\bar z=\cos\alpha-i\sen\alpha$.
    Isso quer dizer que o ângulo da rotação pode ser determinado pelos autovalores da transformação. Mais 
    precisamente o ãngulo da rotação é $\alpha$ onde $\cos\alpha = (z+\bar z)/2$ e 
    $\sen\alpha=(z-\bar z)/(2i)$. 
 \end{example}

 \begin{theorem}\label{th:recog}
    Seja $T:\R^2\to\R^2$ uma transformação ortogonal com dois autovalores $z,\bar z$ onde $z\in\C$ e $\|z\|=1$. 
    Então $T$ é uma rotação por ângulo $\alpha$  onde $\cos\alpha=(z+\bar z)/2$ e $\sen\alpha=(z-\bar z)/(2i)$. 
 \end{theorem}
 \begin{proof}
    Note que $\det T=z\bar z=1$ e pelas considerações anteriores, $T$ é uma rotação. Logo, a matriz de $T$ 
    está na forma 
    \[
        \begin{pmatrix}\cos\alpha &-\sen\alpha \\ \sen\alpha & \cos \alpha\end{pmatrix}.
    \] 
    Usando a computação no exemplo anterior, os autovalores $z$ e  $\bar z$ são 
    $\cos\alpha+i\sen\alpha$ e $\cos\alpha-i\sen\alpha$ e segue a afirmação.
 \end{proof}


\subsection{Realização com números complexos}

O vetor $(\alpha,\beta)\in\R^2$ pode ser identificado com o número complexo $\alpha+i\beta$. 
Cada número complexo $z$ pode ser escrito como $z=\|z\|(\cos \alpha+\sen\alpha)$ onde $\alpha$ é o ângulo 
(frequentamente chamado de argumento) que corresponde a $z$ e $\alpha\in[0,2\pi)$. Um número complexo 
$z$ com $\|z\|=1$ tem a forma $z=\cos\alpha+\sen\alpha$. Pela fórmula de Euler, 
\[
    \cos\alpha+i\sen\alpha = e^{i\alpha}=\exp(i\alpha)
\]

O conjugado de um número $z=\alpha+\beta i$ é $\bar z=\alpha-\beta i$. 

\begin{lemma}
    (1) Seja $z_\alpha=\cos\alpha+i\sen\alpha$. A aplicação 
    \[
        T:\C\to\C,\quad T(z)=z_\alpha\cdot z
    \] 
corresponde a rotação $\rot\alpha$ pelo ângulo $\alpha$ (em torno da origem). 

(2) Seja $T$ a reflexão pelo eixo que tem ângulo $\alpha$ com o eixo $x$. Então 
\[
    T(z)=z_{2\alpha}\cdot \bar z
\]
 \end{lemma}
 \begin{proof}
(1) Seja $z=\|z\|(\cos\beta+\sen\beta)$. Então 
\begin{align*}
    z_\alpha\cdot z&=\|z\|(\cos\alpha+\sen\alpha)(\cos\beta+\sen\beta)\\&=
    \cos\alpha\cos\beta-\cos\alpha\cos\beta+i(\cos\alpha\sen\beta+\sen\alpha\cos\beta)\\&=
    \|z\|(\cos(\alpha+\beta)+i(\cos\alpha+\beta)).
\end{align*}
 
(2) Claramente $\refl 0(z)=\bar z$. Então 
\[
    T(z)=z_{2\alpha}\cdot \bar z=\rot{2\alpha}\refl 0(z)=\refl{\alpha}(z).
\]
 \end{proof}

 \subsection{Os grupos $O(\R^2)=O_2$ e $SO(\R^2)=SO_2$}
 Considere o circulo 
 \[
S^1=\{z\in\C\mid \|z\|=1\}=\{\exp(i\alpha)\mid \alpha\in[0,2\pi)\}.
\]
Temos que $S^1$ é um grupo para a operação de multiplicação. Considere a aplicação
\[
    \psi: S^1\to SO(\R^2),\quad \exp(i\alpha)\mapsto \rot\alpha.
\]
\begin{theorem}
    Temos que $\psi$ é uma aplicação invertível e 
    \[
        \psi(z_1\cdot z_2)=\psi(z_1)\circ \psi(z_2).
    \]
    Ou seja, $\psi$ é um isomorfismo entre os grupos $S^1$ e $SO_3$.
\end{theorem}
\begin{proof}
    Se $\psi(\exp(i\alpha))=\psi(i\beta)$ então $\rot\alpha=\rot\beta$ e, como $\alpha\in[0,2\pi)$, 
    $\alpha=\beta$.  Logo $\psi$ é injetivo. Claramente, $\rot\alpha=\psi(\exp(i\alpha))$ e assim 
    $\psi$ é sobrejetivo.  Agora, 
    \begin{align*}
        \psi(\exp(i\alpha)\exp(i\beta))&=\psi(\exp(i(\alpha+\beta)))=\rot{\alpha+\beta}=\rot\alpha\circ
        \rot\beta\\&=\psi(\exp(i\alpha))\circ\psi(\exp(i\beta))
    \end{align*}
\end{proof}

Note que o grupo $SO_3$ pode ser identificado também com o grupo $[0,2\pi)$ com a operação de adição feita 
"módulo $2\pi$".
 
\begin{lemma}
    Seja $T\in O_2$ uma reflexão. Então $O_2=SO_2\cup tSO_2$. Além disso qualquer 
    rotação pode ser escrita como uma composição de duas reflexões.
\end{lemma}
\begin{proof}
    Exercício.
\end{proof}

\section{O espaço 3D}

\begin{exercise}
    Seja $T:\R^n\to \R^n$ uma transformação ortogonal e $\lambda\in\C$ um autovalor de $T$. Mostre que 
    $|\lambda|=1$. Mostre que se $v_1$ é um autovetor de $T$ com autovalor $1$ e $u$ é um autovetor 
    de $T$ com autovalor $-1$, então $u$ e $v$ são ortogonais ($u\cdot v=0$). 
\end{exercise}

Seja $T:\R^3\to\R^3$ uma transformação ortogonal. Nós já vimos que $\det T=\pm 1$.
A transformação $T$ possui três autovalores (possívelmente complexos) não necessáriamente distintos. 
Além disso, se $z\in\C$ é um autovalor de $T$, então $\|z\|=1$ e $\bar z\in\C$ é também um autovalor de $T$. 
As possibilidades para os autovalores são os seguintes.
\begin{align*}
    \mbox{Caso I}:&1,1,1;\\
    \mbox{Caso II}:&1,1,-1;\\
    \mbox{Caso III}:&1,-1,-1;\\
    \mbox{Caso IV}:&1,z,\bar z\mbox{ com algum $z\in\C\setminus\R$};\\
    \mbox{Caso V}:&-1,-1,-1;\\
    \mbox{Caso VI}:&-1,z,\bar z\mbox{ com algum $z\in\C\setminus\R$}.
\end{align*}

\begin{exercise}
    Dê exemplos de transformações de todos os tipos.
\end{exercise}

\subsection{Rotações em 3D}

\begin{theorem}
    Seja $T:\R^3\to\R^3$ transformação ortogonal com $\det T=1$. 
    Então existe uma base $v_1,v_2,v_3$ ortonormal de $\R^3$ na qual a matriz de $T$ está na forma 
    \[
        [T]=\begin{pmatrix} 1 & 0 & 0\\ 0 & \cos\alpha & -\sen\alpha \\ 0 & 
            \sen\alpha & \cos\alpha\end{pmatrix}
    \]
    Logo, a transformação $T$ é a rotação por ângulo $\alpha$ pelo eixo $v_1$.
\end{theorem}
\begin{proof}
    Se os autovalores são $1,1,1$, então a transformação é a identidade e podemos tomar a base canônica e $\alpha=0$. Se os autovalores são $1,-1,-1$ então toma uma base ortonormal de $\R^n$ formada por autovetores e $\alpha=\pi$. 

    Agora assuma que os autovetores de $T$ são $1,z,\bar z$ com algum $z\in\C\setminus\R$.  
    Seja $v_1$ um autovetor de $T$ com autovalor $1$ (ou seja $T(v_1)=v_1)$. Como $T$ preserva o subespaço 
    $\left<v_1\right>$, $T$ preserva também o subespaço $U=\left<v_1\right>^\perp$. Note que $\dim U=2$ e 
    seja $v_2,v_3$ uma base ortonormal
    de $U$. Então $v_1,v_2,v_3$ é uma base ortonormal de $\R^3$. 
    Seja $T_1$ a restrição de $T$ para $U$. Então $T_1$ preserva o produto escalar em 
    $U$ e assim induz uma transformação ortogonal em $U$ com autovalores $z$ e $\bar z$. Pelo 
    Teorema~\ref{th:recog}, $T_1$ é uma rotação com um ângulo $\alpha$ determinado por $z$ e $\bar z$. 
    A matriz de $T$ na base $v_1,v_2,v_3$ é na forma desejada, e $T$ é a rotação por ângulo $\alpha$ pelo eixo $v_1$.
\end{proof}


Uma transformação ortogonal $T:\R^3\to\R^3$ com determinante $1$ é uma rotação. Pelas 
considerações anteriores, as possíveis autovetores de uma rotação são $1,1,1$ ou  
$1,-1,-1$, ou $1,z,\bar z$ onde 
$z\in\C\setminus\R$ com $\|z\|=1$.

Temos em particular as rotações $\rot{\alpha}^x$, $\rot\beta^y$ e $\rot\gamma^z$ 
por ãngulos $\alpha$, $\beta$ e $\gamma$ em torno dos eixos $x$, $y$, e $z$ respetivamente.
As matrizes destas rotações na base canônica são 
\begin{align*}
    [\rot\alpha^x]&=\begin{pmatrix} 1 & 0 & 0 \\ 0 & \cos\alpha & -\sen\alpha \\ 0 & \sen\alpha & \cos\alpha
    \end{pmatrix}\\
    [\rot\beta^y]&=\begin{pmatrix} \cos\beta & 0 & \sen\beta \\ 0 & 1 & 0 \\  -\sen\beta & 0 & \cos\beta\end{pmatrix}\\
    [\rot\beta^y]&=\begin{pmatrix} \cos\gamma & -\sen\gamma  & 0 \\ \sen\gamma & \cos\gamma & 0 \\ 0 & 0 & 1\end{pmatrix}
\end{align*}

\subsection{A fórmula de Rodrigues}
Seja $k\in\R^3$ um vetor unitário e $\vartheta\in[0,2\pi)$. Considere 
a rotação $R=R(k,\vartheta):\R^3\to\R^3$ pelo ângulo $\vartheta$ ao redor do eixo $k=(k_x,k_y,k_z)$. Seja 
\[ 
    K=\begin{pmatrix} 0 & -k_z & k_y \\ k_z & 0 & -k_x \\ -k_y & k_x & 0\end{pmatrix}.
\]
\begin{lemma}
    Seja $v\in\R^3$. Então $k\times v=Kv$. Em particular, $Kk=0$.
\end{lemma}
\begin{proof}
    Temos que 
    \begin{align*}
        k\times v&=\det\begin{pmatrix} i & j & k \\ k_x & k_y & k_z \\ v_x & v_y & v_z \end{pmatrix}
            =(k_yv_z-k_zv_y,-k_xv_z+k_zv_x,k_xv_y-k_yv_x)\\
            &=\begin{pmatrix} 0 & -k_z & k_y \\ k_z & 0 & -k_x \\ -k_y & k_x & 0\end{pmatrix}\begin{pmatrix} v_x \\ v_y \\ v_z\end{pmatrix}.
    \end{align*}
Ora, $Kk=k\times k=0$.
\end{proof}


\begin{lemma}
    A matriz da rotação $R=R(k,\vartheta)$ na base canônica é 
    \[
        [R]=I+(\sen\vartheta)K+(1-\cos\vartheta)K^2=I+(\sen\vartheta)K+(1-\cos\vartheta)k^tk
    \]
\end{lemma}
\begin{proof}
    Escolha uma base ortonormal de $\R^3$ na forma $k,u,v$ em tal forma que
    $k\times u = v$, $u\times v=k$ e $v\times k=u$ e 
    seja $X=I+(\sen\vartheta)K+(1-\cos\vartheta)K^2$. Como $Kk=K^2k=0$, temos que
    \[
        Xk=(I+(\sen\vartheta) K+(1-\cos\vartheta)K^2)k=Ik=k.
    \]
    Agora 
    \begin{align*}
        Xu&=(I+(\sen\vartheta) K+(1-\cos\vartheta)K^2)u=u+(\sen\vartheta) v-(1-\cos\vartheta)u\\&=
        (\cos\vartheta) u +(\sen\vartheta) v
    \end{align*}
    e
    \begin{align*}
        Xv&=(I+(\sen\vartheta) K+(1-\cos\vartheta)K^2)v=v-(\sen\vartheta)u-(1-\cos\vartheta)v\\&=
        -(\sen\vartheta)u +(\cos\vartheta)v
    \end{align*}
Logo a matriz de $R$ na base $k,u,v$ é 
\[
    \begin{pmatrix} 1 & 0 & 0 \\ 0 & \cos\vartheta & -\sen\vartheta \\ 0 & \sen\vartheta & \cos\vartheta
    \end{pmatrix}.
\]    
Portanto $[R]=X$. 
Para provar a segunda igualdade do lema, note que 
$\|k\|=k_x^2+k_y^2+k_z^2=1$ e assim
\begin{align*}
    K^2&=\begin{pmatrix} 0 & -k_z & k_y \\ k_z & 0 & -k_x \\ -k_y & k_x & 0\end{pmatrix}\cdot \begin{pmatrix} 0 & -k_z & k_y \\ k_z & 0 & -k_x \\ -k_y & k_x & 0\end{pmatrix}\\
    &=\begin{pmatrix} -k_z^2-k_y^2 & k_yk_x & k_zk_x \\
            k_xk_y & -k_z^2-k_x^2 & k_zk_y\\
            k_xk_z & k_yk_z & -k_y^2-k_x^2
    \end{pmatrix}
    =k^t\cdot k-I
\end{align*}
Logo a matriz de $R$ é 
\begin{align*}
    X&=I+(\sen\vartheta) K+(1-\cos)K^2=I+(\sen\vartheta) K+(1-\cos\vartheta)(k^t\cdot k-I)
    \\&=
    (\cos\vartheta) I+(\sen\vartheta) K+(1-\cos\vartheta)k^t\cdot k\\
\end{align*}
\end{proof}

\begin{corollary}
    A matriz de $R(k,\vartheta)$ é 
    \[
        \begin{pmatrix}
            (1-\cos\vartheta)k_x^2+\cos\vartheta & (1-\cos\vartheta)k_xk_y-k_z\sen\vartheta  & 
            (1-\cos\vartheta)k_xk_z+k_y\sen\vartheta \\
            (1-\cos\vartheta)k_xk_y+k_z\sen\vartheta  & (1-\cos\vartheta)k_y^2+\cos\vartheta  & 
            (1-\cos\vartheta)k_yk_z-k_x\sen\vartheta \\
            (1-\cos\vartheta)k_xk_z-k_y\sen\vartheta & (1-\cos\vartheta)k_yk_z+k_x\sen\vartheta  & 
            (1-\cos\vartheta)k_z^2+\cos\vartheta
        \end{pmatrix}.
    \]
\end{corollary}
\begin{proof} Apenas escreva a matriz $(\cos\vartheta) I+(\sen\vartheta) K+(1-\cos\vartheta)k^t\cdot k$.
\end{proof}

\begin{corollary}
    Dada a matriz $X$ da rotação $R(k,\vartheta):\R^3\to\R^3$. Temos que
    \begin{align*}
        \vartheta&=\arccos\frac{X_{11}+X_{22}+X_{33}-1}2\\
        k_x&=\frac{X_{32}-X_{23}}{2\sen\vartheta};\\
        k_y&=\frac{X_{13}-X_{31}}{2\sen\vartheta};\\
        k_z&=\frac{X_{21}-X_{12}}{2\sen\vartheta}.
    \end{align*}
\end{corollary}
\end{document}
 